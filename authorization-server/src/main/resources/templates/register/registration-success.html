<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/base :: html}">
<head>
    <th:block th:fragment="additional-head">
        <title>Registration Successful - ChatCraft Auth</title>
    </th:block>
</head>
<body>
    <th:block th:fragment="content">
        <div class="auth-card auth-card-wide">
            <!-- Success Icon -->
            <div class="success-icon">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
            </div>

            <div class="auth-card-header">
                <h1 class="text-success">Registration Successful!</h1>
                <p>Your organization has been successfully registered with FactorialBot.</p>
            </div>

            <!-- Success Message -->
            <div th:if="${successMessage}" class="alert alert-success" role="alert">
                <span th:text="${successMessage}">Success message</span>
            </div>

            <!-- Tenant Information -->
            <div th:if="${tenant}" class="tenant-info">
                <h3>Organization Details</h3>
                <div class="detail-row">
                    <span class="detail-label">Name:</span>
                    <span class="detail-value" th:text="${tenant.name}">Organization Name</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Domain:</span>
                    <span class="detail-value" th:text="${tenant.domain}">organization-domain</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Created:</span>
                    <span class="detail-value" th:text="${#temporals.format(tenant.createdAt, 'MMM dd, yyyy HH:mm')}">Created Date</span>
                </div>
            </div>

            <!-- OAuth2 Client Credentials -->
            <div th:if="${clientCredentials}" class="credentials-box">
                <h4>OAuth2 Client Credentials</h4>
                <p class="text-muted mb-3">
                    Use these credentials to configure OAuth2 authentication in your applications.
                </p>
                
                <div class="credential-item">
                    <span class="credential-label">Client ID</span>
                    <code class="credential-value" th:text="${clientCredentials.clientId}">client_id_here</code>
                </div>
                
                <div class="credential-item">
                    <span class="credential-label">Client Secret</span>
                    <code class="credential-value">
                        <span class="text-warning">
                            ⚠️ Client secret will be provided separately via secure channel
                        </span>
                    </code>
                </div>
                
                <div class="alert alert-warning mt-3">
                    <strong>Important:</strong> Store these credentials securely. The client secret will not be shown again.
                </div>
            </div>

            <!-- OAuth2 Configuration Info -->
            <div class="credentials-box">
                <h4>OAuth2 Configuration</h4>
                <div class="credential-item">
                    <span class="credential-label">Authorization Endpoint</span>
                    <code class="credential-value" th:text="'http://localhost:9002/auth/oauth2/authorize'">Authorization URL</code>
                </div>
                
                <div class="credential-item">
                    <span class="credential-label">Token Endpoint</span>
                    <code class="credential-value" th:text="'http://localhost:9002/auth/oauth2/token'">Token URL</code>
                </div>
                
                <div class="credential-item">
                    <span class="credential-label">Supported Grant Types</span>
                    <code class="credential-value">authorization_code, refresh_token, client_credentials</code>
                </div>
                
                <div class="credential-item">
                    <span class="credential-label">Default Scopes</span>
                    <code class="credential-value">openid, profile, documents:read, chat:access</code>
                </div>
            </div>

            <!-- Next Steps -->
            <div class="mt-4">
                <h4 class="text-primary">Next Steps</h4>
                <ol>
                    <li class="mb-2">
                        <strong>Check your email</strong> - 
                        <span th:if="${tenant}">
                            An invitation has been sent to set up your administrator account.
                        </span>
                        <span th:unless="${tenant}">
                            You should receive a confirmation email shortly.
                        </span>
                    </li>
                    <li class="mb-2">
                        <strong>Configure your application</strong> - 
                        Use the OAuth2 credentials above to integrate with your applications.
                    </li>
                    <li class="mb-2">
                        <strong>Invite team members</strong> - 
                        Once logged in, you can invite other users to your organization.
                    </li>
                    <li class="mb-2">
                        <strong>Explore features</strong> - 
                        Set up document management and chat functionality for your team.
                    </li>
                </ol>
            </div>

            <!-- Action Buttons -->
            <div class="d-flex justify-content-between mt-4">
                <a th:href="@{/login}" class="btn btn-primary">
                    Continue to Sign In
                </a>
                
                <a href="https://docs.factorialbot.com" target="_blank" class="btn btn-secondary">
                    View Documentation
                </a>
            </div>

            <!-- Support Info -->
            <div class="text-center mt-4">
                <p class="text-muted">
                    Need help? Contact our support team at 
                    <a href="mailto:support@factorialsystems.io" class="text-primary">
                        support@factorialsystems.io
                    </a>
                </p>
            </div>
        </div>
    </th:block>

    <th:block th:fragment="additional-scripts">
        <script>
            // Copy to clipboard functionality
            document.querySelectorAll('.credential-value').forEach(element => {
                element.style.cursor = 'pointer';
                element.title = 'Click to copy';
                
                element.addEventListener('click', function() {
                    const text = this.textContent.trim();
                    if (text && !text.includes('⚠️')) {
                        navigator.clipboard.writeText(text).then(() => {
                            // Show temporary success indicator
                            const originalBg = this.style.backgroundColor;
                            this.style.backgroundColor = '#d4edda';
                            this.title = 'Copied!';
                            
                            setTimeout(() => {
                                this.style.backgroundColor = originalBg;
                                this.title = 'Click to copy';
                            }, 1000);
                        });
                    }
                });
            });
        </script>
    </th:block>
</body>
</html>